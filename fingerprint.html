<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€²éšæ•¸ä½æŒ‡ç´‹åµæ¢ | Advanced Fingerprint Detective</title>
    <style>
        :root {
            --bg-color: #0f172a;
            --text-color: #e2e8f0;
            --accent-color: #38bdf8;
            --alert-color: #ef4444;
            --success-color: #22c55e;
            --panel-bg: #1e293b;
            --border-color: #334155;
            --code-font: 'Consolas', 'Monaco', monospace;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 20px;
        }

        h1 {
            color: var(--accent-color);
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .subtitle {
            color: #94a3b8;
            font-size: 0.9em;
            margin-top: 5px;
        }

        /* Grid Layout for Features */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background-color: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            transition: transform 0.2s;
        }

        .card:hover {
            border-color: var(--accent-color);
        }

        .card h2 {
            margin-top: 0;
            font-size: 1.1em;
            color: var(--success-color);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 8px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .badge {
            background: #334155;
            font-size: 0.7em;
            padding: 2px 6px;
            border-radius: 4px;
            color: #94a3b8;
        }

        .data-item {
            font-family: var(--code-font);
            font-size: 0.85em;
            margin-bottom: 6px;
            display: flex;
            justify-content: space-between;
        }

        .label { color: #94a3b8; }
        .val { color: #e2e8f0; text-align: right; }
        .val.highlight { color: var(--accent-color); }

        /* Fingerprint Result Section */
        .result-section {
            background-color: #000;
            border: 2px solid var(--accent-color);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin-top: 30px;
            position: relative;
            overflow: hidden;
        }

        .result-section::before {
            content: "";
            position: absolute;
            top: 0; left: 0; right: 0; height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent-color), transparent);
            animation: scan 2s infinite;
        }

        @keyframes scan {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .hash-display {
            font-family: var(--code-font);
            font-size: 2em;
            font-weight: bold;
            color: var(--alert-color);
            margin: 10px 0;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
            word-break: break-all;
        }

        button {
            background-color: var(--accent-color);
            color: #0f172a;
            border: none;
            padding: 12px 30px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: block;
            margin: 0 auto 20px auto;
            width: 100%;
            max-width: 400px;
        }

        button:hover {
            background-color: #0ea5e9;
            transform: scale(1.02);
        }

        button:disabled {
            background-color: #475569;
            cursor: not-allowed;
            transform: none;
        }

        .hidden-canvas {
            display: none;
        }
        
        .loading {
            color: var(--accent-color);
            font-family: var(--code-font);
        }

        .explanation {
            font-size: 0.85em;
            color: #64748b;
            margin-top: 5px;
            border-top: 1px dashed #334155;
            padding-top: 5px;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ•µï¸â€â™‚ï¸ é€²éšæ•¸ä½æŒ‡ç´‹åµæ¢</h1>
        <div class="subtitle">Fingerprint Detective v2.0 - æ•™å®¤ç‰ˆ</div>
        <p>å³ä½¿åœ¨è¦æ ¼ç›¸åŒçš„é›»è…¦æ•™å®¤ï¼Œæˆ‘å€‘ä¾ç„¶èƒ½æ‰¾å‡ºä½ çš„ç¨ç‰¹ç‰¹å¾µã€‚</p>
    </header>

    <button id="scanBtn" onclick="startScan()">ğŸ” é–‹å§‹æ·±åº¦æƒæ</button>

    <div id="resultsArea" style="display: none;">
        
        <!-- æœ€çµ‚æŒ‡ç´‹çµæœ -->
        <div class="result-section">
            <div style="color: #94a3b8; text-transform: uppercase; font-size: 0.8em;">Unique Device Identifier</div>
            <div class="hash-display" id="finalHash">CALCULATING...</div>
            <div style="color: var(--success-color); font-size: 0.9em;">
                <span id="entropy-score"></span>
            </div>
        </div>

        <br>

        <div class="grid">
            <!-- 1. è¢å¹•èˆ‡è¦–çª—ç‰¹å¾µ (é‡å°æ•™å®¤ç’°å¢ƒå„ªåŒ–) -->
            <div class="card">
                <h2>ğŸ–¥ï¸ è¦–çª—èˆ‡è¢å¹• <span class="badge">å·®ç•°åŒ–é—œéµ</span></h2>
                <div class="data-item"><span class="label">è¢å¹•è§£æåº¦:</span> <span class="val" id="res"></span></div>
                <div class="data-item"><span class="label">å¯ç”¨å·¥ä½œå€:</span> <span class="val" id="avail-res"></span></div>
                <div class="data-item"><span class="label">è¦–çª—è‰²å½©æ·±åº¦:</span> <span class="val" id="color-depth"></span></div>
                <div class="data-item"><span class="label">åƒç´ æ¯” (DPR):</span> <span class="val" id="dpr"></span></div>
                <div class="explanation">
                    å³ä½¿è¢å¹•ä¸€æ¨£ï¼Œä½ çš„å·¥å…·åˆ—è¨­å®šã€è¦–çª—ç¸®æ”¾æ¯”ä¾‹æˆ–æ˜¯ç€è¦½å™¨æ›¸ç±¤åˆ—ï¼Œéƒ½æœƒæ”¹è®Šã€Œå¯ç”¨å·¥ä½œå€ã€çš„å¤§å°ï¼Œé€™åœ¨æ•™å®¤ä¸­æ˜¯å€åˆ†ä¸åŒäººçš„é—œéµã€‚
                </div>
            </div>

            <!-- 2. ç¡¬é«”ä¸¦ç™¼èˆ‡ç³»çµ± -->
            <div class="card">
                <h2>âš™ï¸ æ ¸å¿ƒç³»çµ± <span class="badge">Hardware</span></h2>
                <div class="data-item"><span class="label">CPU æ ¸å¿ƒæ•¸:</span> <span class="val" id="cores"></span></div>
                <div class="data-item"><span class="label">è¨˜æ†¶é«” (ç´„ç•¥):</span> <span class="val" id="memory"></span></div>
                <div class="data-item"><span class="label">ä½œæ¥­ç³»çµ±:</span> <span class="val" id="os"></span></div>
                <div class="data-item"><span class="label">ç³»çµ±èªç³»:</span> <span class="val" id="lang"></span></div>
                <div class="data-item"><span class="label">æ™‚å€:</span> <span class="val" id="timezone"></span></div>
            </div>

            <!-- 3. Canvas æŒ‡ç´‹ -->
            <div class="card">
                <h2>ğŸ¨ Canvas ç¹ªåœ– <span class="badge">Graphics</span></h2>
                <div class="data-item"><span class="label">æŒ‡ç´‹ä»£ç¢¼:</span> <span class="val highlight" id="canvas-fp"></span></div>
                <div style="text-align: center; margin: 10px 0; background: white; padding: 5px;">
                    <canvas id="fingerprint-canvas" width="200" height="30"></canvas>
                </div>
                <div class="explanation">
                    ç€è¦½å™¨åœ¨èƒŒæ™¯å·å·ç•«äº†ä¸€å¼µå«æœ‰è¡¨æƒ…ç¬¦è™Ÿçš„åœ–ã€‚æ¯å¼µé¡¯å¡çš„æ¸²æŸ“äº›å¾®ä¸åŒï¼Œç”¢ç”Ÿçš„é›œæ¹Šå€¼ä¹Ÿä¸åŒã€‚
                </div>
            </div>

            <!-- 4. WebGL æŒ‡ç´‹ -->
            <div class="card">
                <h2>ğŸ® WebGL é¡¯å¡ <span class="badge">GPU</span></h2>
                <div class="data-item"><span class="label">ä¾›æ‡‰å•†:</span> <span class="val" id="webgl-vendor"></span></div>
                <div class="data-item"><span class="label">æ¸²æŸ“å™¨:</span> <span class="val" id="webgl-renderer"></span></div>
                <div class="explanation">
                    ç›´æ¥è©¢å•ä½ çš„é¡¯ç¤ºå¡å‹è™Ÿèˆ‡é©…å‹•ç¨‹å¼è³‡è¨Šã€‚
                </div>
            </div>

            <!-- 5. Audio æŒ‡ç´‹ (æ–°å¢) -->
            <div class="card">
                <h2>ğŸ”Š Audio éŸ³é » <span class="badge">Advanced</span></h2>
                <div class="data-item"><span class="label">æŒ‡ç´‹ä»£ç¢¼:</span> <span class="val highlight" id="audio-fp">è¨ˆç®—ä¸­...</span></div>
                <div class="data-item"><span class="label">ç‹€æ…‹:</span> <span class="val" id="audio-status">ç­‰å¾…</span></div>
                <div class="explanation">
                    åˆ©ç”¨éŸ³æ•ˆç¡¬é«”çš„ç‰©ç†å·®ç•°ï¼Œç”¢ç”Ÿä¸€æ®µäººè€³è½ä¸è¦‹çš„éŸ³é »ä¸¦åˆ†æå…¶æ³¢å½¢æ•¸æ“šã€‚é€™æ˜¯éå¸¸é›£å½é€ çš„ç‰¹å¾µã€‚
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // ç°¡å–®çš„é›œæ¹Šå‡½æ•¸ (MurmurHash3 æ¦‚å¿µç°¡åŒ–ç‰ˆ)
    function x64hash128(key, seed) {
        var remainder, bytes, h1, h1b, c1, c1b, c2, c2b, k1, i;
        key = key.toString();
        h1 = 0xdeadbeef ^ seed, h1b = 0x41c6ce57 ^ seed;
        c1 = 0x87c37b91, c1b = 0x4cf5ad43; 
        c2 = 0x2dac55d6, c2b = 0x74a44e1a; // Constants
        for (i = 0; i < key.length; i++) {
            k1 = key.charCodeAt(i);
            h1 = Math.imul(h1 ^ k1, c1); 
            h1 = Math.imul(h1 << 13 | h1 >>> 19, 5) + 0xe6546b64;
        }
        h1 ^= key.length;
        h1 ^= h1 >>> 16; h1 = Math.imul(h1, 0x85ebca6b);
        h1 ^= h1 >>> 13; h1 = Math.imul(h1, 0xc2b2ae35);
        h1 ^= h1 >>> 16;
        return h1 >>> 0;
    }

    // 1. æ”¶é›†åŸºæœ¬è³‡è¨Š
    function getBasicInfo() {
        return {
            userAgent: navigator.userAgent,
            language: navigator.language,
            platform: navigator.platform,
            hardwareConcurrency: navigator.hardwareConcurrency || 'N/A',
            deviceMemory: navigator.deviceMemory || 'N/A',
            screenRes: `${screen.width}x${screen.height}`,
            // é—œéµå·®ç•°ï¼šåŠ å…¥ availWidth/Heightï¼Œé€™æœƒå—å·¥å…·åˆ—ã€è¦–çª—è£é£¾å½±éŸ¿
            availScreen: `${screen.availWidth}x${screen.availHeight}`,
            colorDepth: screen.colorDepth,
            pixelRatio: window.devicePixelRatio,
            timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
        };
    }

    // 2. Canvas æŒ‡ç´‹
    function getCanvasFingerprint() {
        const canvas = document.getElementById('fingerprint-canvas');
        const ctx = canvas.getContext('2d');
        // ç¹ªåœ–é‚è¼¯ï¼šæ··åˆæ–‡å­—ã€è¡¨æƒ…ç¬¦è™Ÿã€ç–ŠåŠ æ¨¡å¼
        ctx.textBaseline = "top";
        ctx.font = "14px 'Arial'";
        ctx.textBaseline = "alphabetic";
        ctx.fillStyle = "#f60";
        ctx.fillRect(125, 1, 62, 20);
        ctx.fillStyle = "#069";
        ctx.fillText("Hello World ğŸ‘‹", 2, 15);
        ctx.fillStyle = "rgba(102, 204, 0, 0.7)";
        ctx.fillText("Hello World ğŸ‘‹", 4, 17);
        ctx.strokeStyle = "rgba(255,0,0,0.5)";
        ctx.beginPath();
        ctx.arc(50, 20, 10, 0, Math.PI * 2, true);
        ctx.stroke();
        
        return x64hash128(canvas.toDataURL(), 0);
    }

    // 3. WebGL æŒ‡ç´‹
    function getWebGLFingerprint() {
        const canvas = document.createElement('canvas');
        const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
        if (!gl) return { vendor: 'N/A', renderer: 'N/A' };
        
        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
        if (!debugInfo) return { vendor: 'N/A', renderer: 'N/A' };

        return {
            vendor: gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL),
            renderer: gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL)
        };
    }

    // 4. Audio æŒ‡ç´‹ (é€™æ˜¯æœ€èƒ½å€åˆ†ç¡¬é«”å·®ç•°çš„éƒ¨åˆ†)
    async function getAudioFingerprint() {
        try {
            const audioCtx = new (window.OfflineAudioContext || window.webkitOfflineAudioContext)(1, 44100, 44100);
            const oscillator = audioCtx.createOscillator();
            oscillator.type = 'triangle';
            oscillator.frequency.setValueAtTime(10000, audioCtx.currentTime);
            
            const compressor = audioCtx.createDynamicsCompressor();
            compressor.threshold.setValueAtTime(-50, audioCtx.currentTime);
            compressor.knee.setValueAtTime(40, audioCtx.currentTime);
            compressor.ratio.setValueAtTime(12, audioCtx.currentTime);
            compressor.attack.setValueAtTime(0, audioCtx.currentTime);
            compressor.release.setValueAtTime(0.25, audioCtx.currentTime);

            oscillator.connect(compressor);
            compressor.connect(audioCtx.destination);
            oscillator.start(0);

            const buffer = await audioCtx.startRendering();
            // åªå–éƒ¨åˆ†æ•¸æ“šåš hash
            let output = 0;
            for (let i = 0; i < buffer.length; i += 100) { // å–æ¨£åŠ é€Ÿ
                output += buffer.getChannelData(0)[i];
            }
            return x64hash128(output.toString(), 0);
        } catch (e) {
            return "Not Supported";
        }
    }

    async function startScan() {
        const btn = document.getElementById('scanBtn');
        const results = document.getElementById('resultsArea');
        btn.disabled = true;
        btn.textContent = "åˆ†æä¸­... (æ­£åœ¨æ¡é›†è²ç´‹èˆ‡ç¹ªåœ–ç‰¹å¾µ)";
        results.style.display = 'block';

        // 1. æ”¶é›†åŒæ­¥è³‡è¨Š
        const basic = getBasicInfo();
        const canvasFp = getCanvasFingerprint();
        const webgl = getWebGLFingerprint();

        // å¡«å…¥ UI
        document.getElementById('res').textContent = basic.screenRes;
        document.getElementById('avail-res').textContent = basic.availScreen; // é‡è¦å·®ç•°é»
        document.getElementById('color-depth').textContent = basic.colorDepth + '-bit';
        document.getElementById('dpr').textContent = basic.pixelRatio;
        
        document.getElementById('cores').textContent = basic.hardwareConcurrency;
        document.getElementById('memory').textContent = basic.deviceMemory + ' GB';
        document.getElementById('os').textContent = basic.platform;
        document.getElementById('lang').textContent = basic.language;
        document.getElementById('timezone').textContent = basic.timezone;

        document.getElementById('canvas-fp').textContent = "HASH: " + canvasFp.toString(16);
        
        document.getElementById('webgl-vendor').textContent = webgl.vendor;
        document.getElementById('webgl-renderer').textContent = webgl.renderer;

        // 2. æ”¶é›†éåŒæ­¥è³‡è¨Š (Audio)
        const audioFp = await getAudioFingerprint();
        document.getElementById('audio-fp').textContent = "HASH: " + audioFp.toString(16);
        document.getElementById('audio-status').textContent = "å·²æ¡æ¨£";

        // 3. è¨ˆç®—æœ€çµ‚æŒ‡ç´‹ (æ··åˆæ‰€æœ‰ç‰¹å¾µ)
        const allComponents = [
            basic.userAgent,
            basic.language,
            basic.platform,
            basic.screenRes,
            basic.availScreen, // é€™æ˜¯è®“æ•™å®¤å…§ä¸åŒäººé›œæ¹Šå€¼ä¸åŒçš„é—œéµ
            basic.colorDepth,
            basic.hardwareConcurrency,
            basic.timezone,
            canvasFp,
            webgl.renderer,
            audioFp
        ].join('|||');

        const finalID = x64hash128(allComponents, 123456).toString(16).toUpperCase();
        
        // å‹•ç•«æ•ˆæœé¡¯ç¤ºæœ€çµ‚ ID
        const hashDisplay = document.getElementById('finalHash');
        let count = 0;
        const interval = setInterval(() => {
            hashDisplay.textContent = Math.random().toString(36).substring(2, 10).toUpperCase();
            count++;
            if (count > 10) {
                clearInterval(interval);
                hashDisplay.textContent = "ID: " + finalID;
                btn.textContent = "æƒæå®Œæˆ";
                
                // é¡¯ç¤ºç°¡å–®çš„è§£é‡‹
                document.getElementById('entropy-score').textContent = 
                    "å·²æ¡é›† 5 å¤§é¡å…± 15 é …ç‰¹å¾µå€¼ï¼Œå³ä¾¿åœ¨ç„¡ç—•æ¨¡å¼ä¸‹ ID äº¦ä¸æœƒæ”¹è®Šã€‚";
            }
        }, 50);
    }
</script>

</body>
</html>